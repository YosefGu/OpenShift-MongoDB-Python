
-- create a persistent volume -- 
oc apply -f - <<EOF 
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mongodb-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi   
  storageClassName: gp3
EOF


-- create a mongodb-server --
oc new-app \
    --name=mongodb-server \
   -e MONGODB_USER=username \
   -e MONGODB_PASSWORD=password \
   -e MONGODB_DATABASE=database \
   -e MONGODB_ADMIN_PASSWORD=admin_password \
   registry.access.redhat.com/rhscl/mongodb-26-rhel7


-- connecting mongodb server to pvc --
oc set volumes deploy/mongodb-server \
  --add \
  --claim-name=mongodb-pvc \
  --mount-path=/var/lib/mongodb \
  --name=mongodb-storage \
  --type=persistentVolumeClaim

-- entering to mongo DB in pod --
oc rsh <mongo db pod id>
mongo -u username -p password database

-- create a collection --
db.createCollection("users")

-- add document --
db.<collection name>.insert({data})

oc new-app https://github.com/YosefGu/OpenShift-MongoDB-Python \
    --name=python-mongodb-app \
    -e MONGODB_HOST=mongodb-server \
    -e MONGODB_USER=username \
    -e MONGODB_PASSWORD=password \
    -e MONGODB_DATABASE=database \
    -e MONGODB_ADMIN_PASSWORD=admin_password 


-- create a service for mongodb python server container --
oc expose deployment/python-mongodb-app --port=8001 --target-port=8001 --name=mongodb-python-svc


-- expose the service --
oc expose svc/mongodb-python-svc